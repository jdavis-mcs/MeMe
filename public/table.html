<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Table</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Same Table CSS as before */
        body { font-family: 'Poppins', sans-serif; background: #2c3e50; color: white; margin: 0; padding: 20px; text-align: center; height: 95vh; display: flex; flex-direction: column; }
        #code-screen { position: absolute; top:0; left:0; width:100%; height:100%; background: #34495e; display: flex; align-items: center; justify-content: center; flex-direction: column; z-index: 999; }
        .hidden { display: none !important; }
        /* ... Add rest of previous CSS ... */
        .card { background: white; color: black; width: 200px; height: 280px; padding: 20px; margin: 15px; border-radius: 10px; display: inline-flex; align-items: center; justify-content: center; font-size: 1.3rem; vertical-align: top; }
        .card-facedown { background: #e74c3c; color: transparent; border: 4px solid white; }
    </style>
</head>
<body>

    <div id="code-screen">
        <h1>Spectator View</h1>
        <input type="text" id="room-code" placeholder="Enter 4-Letter Code" style="font-size: 2rem; text-align: center; text-transform: uppercase; padding: 10px; width: 200px;">
        <br>
        <button onclick="joinRoom()" style="padding: 10px 20px; font-size: 1.5rem; cursor: pointer;">Watch Game</button>
    </div>

    <div id="main-ui" class="hidden">
        <h1 id="header-code">Room: ????</h1>
        <h2 id="status-bar">Waiting...</h2>
        
        <div style="flex:1; display:flex; justify-content:center; align-items:center;">
            <img id="meme-img" style="max-height:40vh; max-width:80%; border-radius:10px;">
        </div>
        
        <div id="table-area" style="flex:1; padding:20px;"></div>
        
        <div style="position:absolute; top:20px; right:20px; background:rgba(255,255,255,0.1); padding:15px; border-radius:10px; text-align:left;">
            <h3>Scores</h3>
            <ul id="player-list" style="list-style:none; padding:0;"></ul>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        
        function joinRoom() {
            const code = document.getElementById('room-code').value;
            if(code) {
                socket.emit('joinAsSpectator', code);
            }
        }

        socket.on('spectatorJoined', (code) => {
            document.getElementById('code-screen').classList.add('hidden');
            document.getElementById('main-ui').classList.remove('hidden');
            document.getElementById('header-code').innerText = "Room: " + code;
        });

        socket.on('updatePlayerList', (players) => {
            document.getElementById('player-list').innerHTML = players.map(p => `<li>${p.score} - ${p.name}</li>`).join('');
        });

        socket.on('newRound', (data) => {
            document.getElementById('meme-img').src = data.memeUrl;
            document.getElementById('table-area').innerHTML = '';
            document.getElementById('status-bar').innerText = "Thinking...";
        });

        socket.on('cardPlayedAnonymously', (count) => {
            const area = document.getElementById('table-area');
            area.innerHTML = '';
            for(let i=0; i<count; i++) {
                const c = document.createElement('div');
                c.className = 'card card-facedown';
                area.appendChild(c);
            }
        });

        socket.on('revealCards', (submissions) => {
            const area = document.getElementById('table-area');
            area.innerHTML = '';
            submissions.forEach(sub => {
                const c = document.createElement('div');
                c.className = 'card';
                c.innerText = sub.text;
                area.appendChild(c);
            });
            document.getElementById('status-bar').innerText = "Judging...";
        });

        socket.on('roundWinner', (name) => {
            document.getElementById('status-bar').innerText = "Winner: " + name;
        });
    </script>
</body>
</html>
